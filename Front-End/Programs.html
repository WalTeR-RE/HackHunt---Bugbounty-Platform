<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Available Programs â€“ HackHunt</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="favicon.ico" />
</head>
<body class="bg-gray-950 text-white font-sans">

  <!-- Navbar -->
  <header class="bg-gray-900 shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-purple-500">HackHunt</h1>
      <nav class="space-x-6 hidden md:block">
        <a href="/" class="hover:text-purple-400">Home</a>
        <a href="#programs" class="hover:text-purple-400">Programs</a>
        <a href="#halloffame" class="hover:text-purple-400">Hall of Fame</a>
        <a href="#join" class="bg-purple-600 px-4 py-2 rounded-xl hover:bg-purple-700 transition">Join Now</a>
      </nav>
    </div>
  </header>

  <!-- Programs Section -->
  <section id="programs" class="py-20 bg-gray-950">
    <div class="max-w-6xl mx-auto px-6 text-center">
      <h2 class="text-3xl font-bold text-purple-500 mb-8">Available Bug Bounty Programs</h2>
      <div id="programList" class="grid md:grid-cols-3 gap-6"></div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-center py-6 text-gray-500">
    &copy; 2025 HackHunt. All rights reserved.
  </footer>

  <!-- Script -->
  <script>
    document.addEventListener("DOMContentLoaded", async function () {
      const token = localStorage.getItem("token");
      if (!token) {
        alert("You must be logged in to view available programs.");
        return;
      }

      const response = await fetch("http://127.0.0.1:8000/api/researchers/programs", {
        headers: {
          "Authorization": `Bearer ${token}`,
          "Content-Type": "application/json"
        }
      });

      const programs = await response.json();
      const container = document.getElementById("programList");

      programs.forEach(program => {
        const card = document.createElement("div");
        card.className = "bg-gray-900 rounded-xl p-6 shadow-lg hover:shadow-purple-500/20 transition text-left";

        const rewards = program.rewards.map(r => `<span class="inline-block bg-purple-700 text-white px-2 py-1 rounded text-xs mr-2 mb-1">${r.type.toUpperCase()}: ${r.amount}</span>`).join("");

        card.innerHTML = `
          <h3 class="text-xl font-semibold text-purple-400 mb-2 cursor-pointer hover:underline">
  <a href="Program.html?uuid=${program.program_id}">${program.name}</a>
</h3>
          <p class="text-sm text-gray-300 mb-3">${program.fast_description}</p>
          <div class="mb-3">
            ${rewards}
          </div>
          <p class="text-xs text-gray-400">Bounty Range: ${program.bounty_range}</p>
          <p class="text-xs text-gray-400">Reports: ${program.number_of_reports}</p>
          <p class="text-xs text-gray-400">Status: <span class="font-semibold text-green-400">${program.status}</span></p>
        `;

        container.appendChild(card);
      });
    });
  </script>

</body>
</html>
